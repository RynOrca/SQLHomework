<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>上架 - GameKey Hub</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); min-height: 100vh; color: #f0f0f0; padding-top: 50px; }
        .card { background: rgba(255,255,255,0.08); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); border-radius: 16px; }
        .form-control, .form-select { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; }
        .form-control:focus, .form-select:focus { background: rgba(255,255,255,0.15); color: white; border-color: #4cc9f0; box-shadow: none; }
        option { background: #16213e; }
    </style>
</head>
<body>
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card p-4 shadow">
                <h4 class="mb-4 border-bottom pb-2">发布闲置 CDKey</h4>
                <form id="sellForm">
                    <div class="mb-3">
                        <label class="form-label">选择游戏</label>
                        <select name="game_id" class="form-select" required>
                            {% for game in games %}<option value="{{ game.game_id }}">{{ game.title }}</option>{% endfor %}
                        </select>
                    </div>
                    <div class="mb-3"><label class="form-label">Key</label><input type="text" name="cdk_code" class="form-control" required></div>
                    <div class="mb-3"><label class="form-label">价格</label><input type="number" step="0.01" name="price" class="form-control" required></div>
                    <button type="button" onclick="sub()" class="btn btn-primary w-100">上架</button>
                    <a href="/" class="btn btn-link w-100 mt-2 text-decoration-none text-muted">返回</a>
                </form>
            </div>
        </div>
    </div>
</div>
<script>
function sub() {
    fetch('/sell', { method: 'POST', body: new FormData(document.getElementById('sellForm')) })
    .then(r=>r.json()).then(d=>{ alert(d.msg); if(d.status==='success') location.href='/'; });
}
</script>
</body>
</html>